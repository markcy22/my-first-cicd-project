name: CI/CD Pipeline with Environments

on:
  push:
    branches: [ main, dev ]
  pull_request:
    branches: [ main, dev ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Verify HTML file exists
      run: |
        echo "Checking if index.html exists..."
        if [ -f "index.html" ]; then
          echo "âœ… index.html found!"
        else
          echo "âŒ index.html not found!"
          exit 1
        fi
    
    - name: Check HTML structure
      run: |
        echo "Checking HTML structure..."
        if grep -q "<title>" index.html; then
          echo "âœ… HTML structure looks good!"
        else
          echo "âŒ HTML structure issue detected!"
          exit 1
        fi
    
    - name: Run quality checks
      run: |
        echo "Running additional quality checks..."
        echo "âœ… All quality checks passed!"
  
  deploy-dev:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/dev' && github.event_name == 'push'
    
    steps:
    - name: Deploy to Development
      run: |
        echo "ğŸš€ Deploying to DEVELOPMENT environment..."
        echo "ğŸ“ Environment: DEV"
        echo "ğŸŒ URL: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"
        echo "âœ… Development deployment complete!"
  
  deploy-production:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    
    steps:
    - name: Deploy to Production
      run: |
        echo "ğŸš€ Deploying to PRODUCTION environment..."
        echo "ğŸ“ Environment: PRODUCTION"
        echo "ğŸŒ URL: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"
        echo "âš ï¸  This is the LIVE site with real users!"
        echo "âœ… Production deployment complete!"
